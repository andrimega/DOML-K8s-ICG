<?xml version="1.0" encoding="ASCII"?>
<commons:DOMLModel xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:app="http://www.piacere-project.eu/doml/application" xmlns:commons="http://www.piacere-project.eu/doml/commons" xmlns:infra="http://www.piacere-project.eu/doml/infrastructure" xmlns:opt="http://www.piacere-project.eu/doml/optimization" name="doml_example1" version="3.1" activeConfiguration="//@configurations.0" activeInfrastructure="//@concretizations.0">
  <application name="app_example1">
    <components xsi:type="app:DBMS" name="mysql" isPersistent="false">
      <exposedInterfaces name="sql_interface"/>
    </components>
    <components xsi:type="app:SoftwareComponent" name="nginx" isPersistent="false" consumedInterfaces="//@application/@components.0/@exposedInterfaces.0"/>
  </application>
  <infrastructure name="infra_example1">
    <nodes xsi:type="infra:VirtualMachine" name="nginx_vm" architecture="x86-64" os="Ubuntu-22.04.2-LTS" memory_mb="1024.0" storage="16.0" cpu_count="1" credentials="//@infrastructure/@credentials.0" sizeDescription="small">
      <ifaces name="nginx_iface" belongsTo="//@infrastructure/@networks.0/@subnets.0" associated="//@infrastructure/@securityGroups.0"/>
      <location region="00EU"/>
    </nodes>
    <nodes xsi:type="infra:VirtualMachine" name="mysql_vm" architecture="x86-64" os="Ubuntu-22.04.2-LTS" memory_mb="1024.0" storage="16.0" cpu_count="1" credentials="//@infrastructure/@credentials.1" sizeDescription="small">
      <ifaces name="mysql_iface" belongsTo="//@infrastructure/@networks.0/@subnets.1" associated="//@infrastructure/@securityGroups.0"/>
      <location region="00EU"/>
    </nodes>
    <credentials xsi:type="commons:KeyPair" name="nginx_vm_credentials" user="nginx_user" key="AAAAB3NzaC1yc2EAAAADAQABAAABAQC63ZvocMhX1LsdUlhzqLNSsh/Wotk/EMfDfa9pBHC52NXv05uENTjd/LBj8PS5JXEr7rKG9Zpj2Kj/PA7Gu0X1BZMwAiNR2dKjw9K0HO6Ozj3elCA7WjjotiQcO+OLWefE1PUW8/BJjtjFD/qf6wJd8CwInH8cjpkccQQfA55IXXegQMm5qv2a/S2XBvMMzv1dzsCy5UPO7tiOz4RBfi56JK8o2mDR327yY7+goA0HQz5tSN1X98+vxLpTPD5qINEFfVk1yNmf/ls3C7EBZQFJ6tsHgl070ymdBLHccmDMEYktzBnc/IhNWMq7K4IxwgFfQ7YSzAAqMr1n04+3oUeB" algorithm="RSA" bits="4096"/>
    <credentials xsi:type="commons:KeyPair" name="mysql_vm_credentials" user="mysql_user" key="AAAAB3NzaC1yc2EAAAADAQABAAABAQCBiNSYpUJ9bCNhmFdEmCqF0WCW0f47SDN3T43nF5rDI06Ixuedk9+TlAUZudistB/RTlq0AaQmaZjBdQFkDvLiKnmEAB16eITQ/lz+eODcK5540E3Qd5jlq9DOy3s8eVaL8zg1zwaSktIJ/Y/jGyiy/MM1uobj/JNGNE++llYwh6/SjynGADo9bNcboJifLoU51lrJbyO6w7SJyeP28X46Dd6ob/GQwPAEZjhW+0U+K/JeDfIA1wYH6fC15K1pte9n57gd4RK+yRn7r45c0dP5M4gzZsZrXXaWRI/Dgbha08zSlKEzFdT7QcExMu+W6jGPZiHUSUAZJBxfRORHZ8iP" algorithm="RSA" bits="4096"/>
    <securityGroups name="sec_group" ifaces="//@infrastructure/@nodes.0/@ifaces.0 //@infrastructure/@nodes.1/@ifaces.0">
      <rules name="icmp" protocol="ICMP" fromPort="-1" toPort="-1">
        <cidr>0.0.0.0/0</cidr>
      </rules>
      <rules name="ssh" kind="INGRESS" protocol="TCP" fromPort="22" toPort="22">
        <cidr>0.0.0.0/0</cidr>
      </rules>
      <rules name="http" kind="INGRESS" protocol="TCP" fromPort="80" toPort="80">
        <cidr>0.0.0.0/0</cidr>
      </rules>
      <rules name="https" kind="INGRESS" protocol="TCP" fromPort="443" toPort="443">
        <cidr>0.0.0.0/0</cidr>
      </rules>
    </securityGroups>
    <networks name="common_network" protocol="TCP/IP">
      <gateways name="igw1" address="10.0.144.22"/>
      <subnets name="nginx_subnet" protocol="TCP/IP" connectedIfaces="//@infrastructure/@nodes.0/@ifaces.0" connectedTo="//@infrastructure/@networks.0/@subnets.1"/>
      <subnets name="mysql_subnet" protocol="TCP/IP" connectedIfaces="//@infrastructure/@nodes.1/@ifaces.0" connectedTo="//@infrastructure/@networks.0/@subnets.0"/>
    </networks>
  </infrastructure>
  <concretizations name="concrete_example1">
    <providers name="openstack">
      <vms name="concrete_nginx_vm" preexisting="false" maps="//@infrastructure/@nodes.0"/>
      <vms name="concrete_mysql_vm" preexisting="false" maps="//@infrastructure/@nodes.1"/>
      <networks name="concrete_common_network" preexisting="false" protocol="TCP/IP" addressRange="10.0.144.0/24" maps="//@infrastructure/@networks.0">
        <subnets name="concrete_nginx_subnet" preexisting="false" addressRange="10.0.144.0/25" maps="//@infrastructure/@networks.0/@subnets.0"/>
        <subnets name="concrete_mysql_subnet" preexisting="false" addressRange="10.0.144.128/25" maps="//@infrastructure/@networks.0/@subnets.1"/>
      </networks>
    </providers>
  </concretizations>
  <optimization name="opt">
    <objectives xsi:type="opt:MeasurableObjective" kind="max" property="availability"/>
    <objectives xsi:type="opt:MeasurableObjective" kind="max" property="performance"/>
    <nonfunctionalRequirements xsi:type="commons:EnumeratedRequirement" name="Req1" description="Region" property="region">
      <values>00EU</values>
    </nonfunctionalRequirements>
    <nonfunctionalRequirements xsi:type="commons:EnumeratedRequirement" name="Req2" description="Provider" property="provider">
      <values>openstack</values>
    </nonfunctionalRequirements>
    <nonfunctionalRequirements name="Req3" description="elements" property="VM VM"/>
  </optimization>
  <configurations name="config_example1">
    <deployments component="//@application/@components.0" node="//@infrastructure/@nodes.1"/>
    <deployments component="//@application/@components.1" node="//@infrastructure/@nodes.0"/>
  </configurations>
</commons:DOMLModel>
